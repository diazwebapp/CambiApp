---
import Layout from '../layouts/Layout.astro';

const cards = [
  {
    icon: "📊",
    title: "Calculadora",
    description: "Convierte entre dólares y bolívares",
    href: "/calculadora"
  },
  {
    icon: "📈",
    title: "Histórico",
    description: "Ver tendencias de tasas de cambio",
    href: "/historial"
  },
  {
    icon: "👤",
    title: "Perfiles Bancarios",
    description: "Guarda tus datos bancarios",
    href: "/perfiles"
  },
  {
    icon: "💰",
    title: "Comparador de Ahorro",
    description: "Calcula tu ahorro entre tasas",
    href: "/comparador"
  },
  {
    icon: "⚙️",
    title: "Administración",
    description: "Gestiona las tasas de cambio",
    href: "/admin"
  }
];
---

<Layout title="CambiApp">
  <div class="container">
    <h2 class="welcome-title">Bienvenido a CambiApp</h2>
    
    <div class="cards-grid">
      {cards.map(card => (
        <a href={card.href} class="card">
          <span class="card-icon">{card.icon}</span>
          <div class="card-content">
            <h3>{card.title}</h3>
            <p>{card.description}</p>
          </div>
        </a>
      ))}
    </div>

    <div class="rates-info">
      <h3>Tasas del día</h3>
      <div class="rates">
        <strong>Oficial:</strong> <p id="bcv" style="line-height:1.2 !important;">35.25 Bs/$</p>
        <strong>Paralelo:</strong> <p id="paralelo" style="line-height:1.2 !important;">37.80 Bs/$</p>
        <strong>Promedio:</strong> <p id="promedio" style="line-height:1.2 !important;">36.52 Bs/$</p>
      </div>
      <p class="update-time">Última actualización: 20/05/2023 - 10:00 AM</p>
    </div>
  </div>
</Layout>

<style>
  .container {
    padding: 2rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .welcome-title {
    text-align: center;
    margin-bottom: 2rem;
    font-size: 2rem;
    
  }

  .cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .card {
    background-color: var(--bg-cards);
    border-radius: var(--rounded);
    padding: 1.5rem;
    text-decoration: none;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px var(--color-borders);
  }

  .card-icon {
    font-size: 1.3rem;
    width: 60px;height: 60px; border-radius: 99999px;
    background-color: var(--primary);
    text-align: center;
    padding-top: .7rem;
  }

  .card-content h3 {
    margin: 0;
    font-size: 1.25rem;
    
  }

  .card-content p {
    margin: 0.5rem 0 0;
    font-size: 0.9rem;
    opacity: .7;
  }

  .rates-info {
    background-color: var(--bg-cards);
    border-radius: var(--rounded);
    padding: 1.5rem;
    margin-top: 2rem;
  }

  .rates-info h3 {
    margin: 0 0 1rem;
    color: var(--primary);
    
  }

  .rates {
    display: flex;
    flex-flow: row nowrap;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .rates p, .rates strong {
    margin: 0;
    font-size: .8rem;
  }

  .update-time {
    font-size: 0.9rem;
    opacity: .7;
    margin: 0;
  }

  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }

    .cards-grid {
      grid-template-columns: 1fr;
    }

    .rates {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  document.addEventListener("astro:page-load",()=>{
    if(window.SharedWorker){
              
      window.sharedWorker.port.onmessage = (event) => {
        const {rates} = event.data.response
        if(rates){
            const {paralelo,bcv} = rates
            const promedio = parseFloat((paralelo + bcv) / 2).toFixed(2)
            
              const bcvElement = document.getElementById("bcv")
              const paraleloElement = document.getElementById("paralelo")
               const promedioElement = document.getElementById("promedio")
              if(bcvElement) bcvElement.textContent = bcv+" Bs/$"
              if(paraleloElement) paraleloElement.textContent = paralelo+" Bs/$"
              if(promedioElement) promedioElement.textContent = promedio+" Bs/$"
            
        }
      };
      
    }
  })
</script>